# Полное руководство

## Соглашения принятые в документации

`< имя_параметра >` - в угловых скобках обозначаются обязательные аргументы

`[ имя_параметра ]` - в квадратынх скобках обозначаются не обязательные аргументы

***имя_параметра*** - жирным курсивом выделются имена параметров

:triangular_flag_on_post: - подобным образом обозначается важные моменты, на которые нужно обратить внимание

Все примеры доступны в каталоге `docs/examples`

Для некоторых примеров используется заголовок `example:[название примера]`,
чтобы не было пересечения с правилами из других примеров. 
На него в примерах не нужно фокусировать внимание

Для облегчения чтения, если в примере ответа http-код не указан, то подразумевается код `200`

Для описания запросов к серверу используется синтаксис утилиты `curl`

Все примеры запросов к серверу можно импортировать в `postman` из
[файла](examples.postman_collection.json)

## Запуск

Для запуска сервера необходимо выполнить следующую команду:

`docker run -p <port>:80 [-e TZ=timezone] -v <rules_path>:/app/rules  mnkvsoft/lira`

либо добавить следующие строки в docker-compose

```
lira:
    container_name: lira
    image: mnkvsoft/lira
    ports:
      - "<port>:80"
    volumes:
       - <rules_path>:/app/rules
```

***port*** - номер порта, который будет слушать сервер

***rules_path*** - каталог в котором будут содержать правила 
и другие файлы (далее **рабочий каталог**), обрабатываемые сервером

***timezone*** - часовой пояс, например `Europe/Moscow`

## Обработка рабочего каталога

При своей работе **LIRA** постоянно отслеживает рабочий каталог на предмет 
изменений и если они появились, то выполняет загрузку актуальных правил.

Файлы правил должны иметь расширение `.rules`. 

**LIRA** выполняет отслеживание обрабатываемых файлов вне зависимости от их расположения в рабочем каталого 
(т.е. вложенность каталогов не имеет значения).

После добавления или изменений правил для того, чтобы проверить результат загрузки правил 
можно вызвать комманду

`GET http://localhost/sys/state`

которая отобразит текущее состояние сервера со временем последней загрузки. 

Пример результата запроса

`Ok. Load time: 09/23/2023 14:54:46 (146 second ago)`

## Что дальше?
[Cопоставление запросов](matching.md)
